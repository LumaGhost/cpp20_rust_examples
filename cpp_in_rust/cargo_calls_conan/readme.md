**overview**

in this case we have an example cpp library "cpp_library" which has a c api and is packaged with conan. we then have a rust library cpp_library-sys which provides the rust api for the cpp library and wraps the fetching and building of the cpp library so that cpp_library-sys can function similar to a typical cargo project. 

**layout**

[cpp_library-sys](cpp_library-sys) for the most part this is a regular cargo library created with `cargo new`. in addition we have a conan.txt file which lists our cpp dependencies and also specifies that we want to use the pkg config generator (i.e. we want conan to generate .pc files to help us locate the installed cpp library). we also have a build.rs file thats responsible for invoking conan and then using the pkg config crate which consumes the pc files created by conan and automatically sets up cargo/rustc to find our cpp librarires (: beyond that, there is some additional nuance with runtime search paths which i'll explain in the additional thoughts section. 

[cpp_library](cpp_library-sys/cpp_library) this folder represents an example cpp library packaged with conan. this library was generated with the following conan command `conan new meson_lib -d name=cpp_library -d version=0.0 -d requires=fmt/9.1.0`. while this library lives in source for this example it doesnt need to in practice. as long as the cpp library is packaged with conan and has a c api it will work for this approach. 

**workflow**

cpp_library-sys is basically just a cargo project, so cargo comands such as `cargo test` will work. if you are building this project locally, you will need to create a local instance of the cpp_library conan package first with `conan create`. an example of this workflow is available in our github actions yml.

**additional thoughts**

runtime search paths: at this time i am not aware of any functionality in cargo for setting runtime search paths for external native dynamic library dependencies. so when we bring in our own native c/c++ library built outside of cargo, we are responsible for setting the runtime search paths ourselves. on mac and linux my approach was to set the dyld/ld library search path, and on windows i opted instead to use the virtual enviornments generated by conan since i was having difficulty setting the PATH correctly myself. 

